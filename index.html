<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>SATURN</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
:root {
  --bg: var(--tg-theme-bg-color, #ffffff);
  --text: var(--tg-theme-text-color, #000000);
  --hint: var(--tg-theme-hint-color, #8e8e93);
  --button: var(--tg-theme-button-color, #3390ec);
  --button-text: var(--tg-theme-button-text-color, #ffffff);
}

/* Reset */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  -webkit-tap-highlight-color: transparent;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text",
               "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  background: var(--bg);
  color: var(--text);
  height: 100vh;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  -webkit-font-smoothing: antialiased;
}

/* Header user */
.user-profile {
  position: fixed;
  top: 12px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 14px;
  font-weight: 500;
  opacity: .9;
}

.user-avatar {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  background: var(--button);
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

.user-avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

/* Main */
.content {
  flex: 1;
  padding: 24px;
  padding-top: 80px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
}

/* Emoji / loader */
.emoji-box {
  width: 140px;
  height: 140px;
  margin-bottom: 20px;
  position: relative;
}

.loader {
  width: 36px;
  height: 36px;
  border: 3px solid rgba(0,0,0,.08);
  border-top-color: var(--button);
  border-radius: 50%;
  animation: spin .9s linear infinite;
  position: absolute;
  inset: 0;
  margin: auto;
}

@keyframes spin { to { transform: rotate(360deg); } }

.status-gif {
  width: 100%;
  height: 100%;
  object-fit: contain;
  opacity: 0;
  transform: scale(.92);
  transition: .35s ease;
}

.loaded .status-gif {
  opacity: 1;
  transform: scale(1);
}

.loaded .loader {
  opacity: 0;
}

/* Text */
.title {
  font-size: 20px;
  font-weight: 600;
  margin-bottom: 6px;
}

.subtitle {
  font-size: 15px;
  color: var(--hint);
  line-height: 1.4;
  max-width: 260px;
}

/* Footer */
.footer {
  padding: 16px;
  padding-bottom: calc(16px + env(safe-area-inset-bottom));
  opacity: 0;
  transform: translateY(16px);
  transition: .35s ease;
}

.footer.visible {
  opacity: 1;
  transform: translateY(0);
}

/* Telegram Button */
.tg-btn {
  width: 100%;
  height: 50px;
  border-radius: 14px;
  border: none;
  background: var(--button);
  color: var(--button-text);
  font-size: 16px;
  font-weight: 600;
}
</style>
</head>

<body>

<div class="user-profile" id="user-profile" hidden>
  <div class="user-avatar" id="user-avatar"></div>
  <div id="user-name"></div>
</div>

<div class="content" id="main">
  <div class="emoji-box" id="emoji-box">
    <div class="loader"></div>
    <img id="status-emoji" class="status-gif">
  </div>

  <div class="title" id="title">Открываем</div>
  <div class="subtitle" id="subtitle">Это займёт пару секунд</div>
</div>

<div class="footer" id="footer">
  <button class="tg-btn" onclick="location.reload()">Попробовать снова</button>
</div>

<script>
const tg = window.Telegram.WebApp;
tg.ready();
tg.expand();

document.body.style.background = tg.themeParams.bg_color || '#fff';

const user = tg.initDataUnsafe?.user;
if (user) {
  document.getElementById('user-profile').hidden = false;
  document.getElementById('user-name').textContent = user.first_name;
  const av = document.getElementById('user-avatar');
  user.photo_url
    ? av.innerHTML = `<img src="${user.photo_url}">`
    : av.textContent = user.first_name[0];
}

function setImage(src) {
  const box = document.getElementById('emoji-box');
  const img = document.getElementById('status-emoji');
  box.classList.remove('loaded');
  img.onload = () => box.classList.add('loaded');
  img.src = src;
}
</script>

</body>
</html>
